---
openapi: 3.0.1
info:
  title: Sewer Line Repair API
  version: v1
  description: REST API for managing sewer line repairs
paths:
  "/api/v1/companies/search":
    get:
      summary: Search companies
      tags:
      - Companies
      parameters:
      - name: city
        in: query
        required: false
        description: Filter by city name
        schema:
          type: string
      - name: state
        in: query
        required: false
        description: Filter by state code or name
        schema:
          type: string
      - name: country
        in: query
        required: false
        description: Filter by country code or name
        schema:
          type: string
      - name: lat
        in: query
        required: false
        description: Latitude for location-based search
        schema:
          type: number
      - name: lng
        in: query
        required: false
        description: Longitude for location-based search
        schema:
          type: number
      - name: radius
        in: query
        required: false
        description: 'Search radius in miles (default: 25)'
        schema:
          type: number
      - name: address
        in: query
        required: false
        description: Address to geocode and search near
        schema:
          type: string
      - name: service_category
        in: query
        required: false
        description: Filter by service category slug or name
        schema:
          type: string
      - name: verified_only
        in: query
        required: false
        description: Show only verified professionals
        schema:
          type: boolean
      - name: min_rating
        in: query
        required: false
        description: Minimum average rating (0-5)
        schema:
          type: number
      - name: sort
        in: query
        required: false
        description: Sort by field (name, rating, -name, -rating)
        schema:
          type: string
      - name: page
        in: query
        required: false
        description: 'Page number (default: 1)'
        schema:
          type: integer
      - name: per_page
        in: query
        required: false
        description: 'Items per page (default: 20, max: 100)'
        schema:
          type: integer
      responses:
        '200':
          description: no results found
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                        type:
                          type: string
                          example: company
                        attributes:
                          type: object
                          properties:
                            name:
                              type: string
                            slug:
                              type: string
                            phone:
                              type: string
                            email:
                              type: string
                            website:
                              type: string
                            average_rating:
                              type: string
                            total_reviews:
                              type: integer
                            verified_professional:
                              type: boolean
                        relationships:
                          type: object
                        links:
                          type: object
                          properties:
                            self:
                              type: string
                  meta:
                    type: object
                    properties:
                      pagination:
                        type: object
                        properties:
                          current_page:
                            type: integer
                          per_page:
                            type: integer
                          total_pages:
                            type: integer
                          total_count:
                            type: integer
                  links:
                    type: object
  "/api/v1/companies/{id}":
    parameters:
    - name: id
      in: path
      description: Company ID
      required: true
      schema:
        type: string
    get:
      summary: Show company details
      tags:
      - Companies
      description: Get detailed information about a specific company
      responses:
        '200':
          description: successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                      type:
                        type: string
                      attributes:
                        type: object
                      relationships:
                        type: object
                      links:
                        type: object
                  included:
                    type: array
        '404':
          description: company not found
  "/api/v1/locations/autocomplete":
    get:
      summary: Autocomplete location search
      tags:
      - Locations
      description: Search for cities, states, and countries with autocomplete
      parameters:
      - name: q
        in: query
        required: true
        description: Search query (minimum 2 characters)
        schema:
          type: string
      - name: type
        in: query
        required: false
        description: Filter by type (city, state, country)
        schema:
          type: string
      - name: limit
        in: query
        required: false
        description: 'Maximum results to return (default: 10, max: 50)'
        schema:
          type: integer
      responses:
        '200':
          description: successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                        type:
                          type: string
                          enum:
                          - city
                          - state
                          - country
                        name:
                          type: string
                        full_name:
                          type: string
                        state:
                          type: string
                        state_code:
                          type: string
                        code:
                          type: string
                  meta:
                    type: object
                    properties:
                      query:
                        type: string
                      count:
                        type: integer
                      limit:
                        type: integer
        '400':
          description: query too short
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      type: object
                      properties:
                        status:
                          type: string
                        code:
                          type: string
                        title:
                          type: string
  "/api/v1/companies/{company_id}/reviews":
    parameters:
    - name: company_id
      in: path
      description: Company ID
      required: true
      schema:
        type: string
    get:
      summary: List company reviews
      tags:
      - Reviews
      description: Get paginated list of reviews for a specific company
      parameters:
      - name: min_rating
        in: query
        required: false
        description: Minimum rating filter (1-5)
        schema:
          type: number
      - name: sort
        in: query
        required: false
        description: Sort by field (review_rating, review_datetime_utc, -review_rating,
          -review_datetime_utc)
        schema:
          type: string
      - name: page
        in: query
        required: false
        description: 'Page number (default: 1)'
        schema:
          type: integer
      - name: per_page
        in: query
        required: false
        description: 'Items per page (default: 20, max: 100)'
        schema:
          type: integer
      responses:
        '200':
          description: successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                        type:
                          type: string
                          example: review
                        attributes:
                          type: object
                          properties:
                            author_title:
                              type: string
                            author_image:
                              type: string
                            review_rating:
                              type: integer
                            review_text:
                              type: string
                            review_datetime_utc:
                              type: string
                              format: datetime
                            review_link:
                              type: string
                            review_img_urls:
                              type: array
                              items:
                                type: string
                            owner_answer:
                              type: string
                            owner_answer_timestamp_datetime_utc:
                              type: string
                              format: datetime
                        relationships:
                          type: object
                        links:
                          type: object
                  meta:
                    type: object
                    properties:
                      rating_distribution:
                        type: object
                        properties:
                          '5':
                            type: integer
                          '4':
                            type: integer
                          '3':
                            type: integer
                          '2':
                            type: integer
                          '1':
                            type: integer
                      pagination:
                        type: object
                  links:
                    type: object
        '404':
          description: company not found
  "/api/v1/states/{state_slug}/companies":
    parameters:
    - name: state_slug
      in: path
      description: State slug
      required: true
      schema:
        type: string
    get:
      summary: List companies in a state
      tags:
      - States
      parameters:
      - name: city
        in: query
        required: false
        description: Filter by city name or slug
        schema:
          type: string
      - name: service_category
        in: query
        required: false
        description: Filter by service category slug or name
        schema:
          type: string
      - name: verified_only
        in: query
        required: false
        description: Show only verified professionals
        schema:
          type: boolean
      - name: min_rating
        in: query
        required: false
        description: Minimum average rating (0-5)
        schema:
          type: number
      - name: sort
        in: query
        required: false
        description: Sort by field (name, rating, -name, -rating)
        schema:
          type: string
      - name: page
        in: query
        required: false
        description: 'Page number (default: 1)'
        schema:
          type: integer
      - name: per_page
        in: query
        required: false
        description: 'Items per page (default: 20, max: 100)'
        schema:
          type: integer
      responses:
        '200':
          description: successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                        type:
                          type: string
                          example: company
                        attributes:
                          type: object
                        relationships:
                          type: object
                        links:
                          type: object
                  meta:
                    type: object
                    properties:
                      pagination:
                        type: object
                      cities:
                        type:
                        - object
                        - 'null'
                  links:
                    type: object
        '404':
          description: state not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      type: object
                      properties:
                        status:
                          type: string
                        code:
                          type: string
                        title:
                          type: string
servers:
- url: http://localhost:3000
  description: Development server
- url: https://{defaultHost}
  variables:
    defaultHost:
      default: api.example.com
  description: Production server
components:
  schemas: {}
  securitySchemes: {}
