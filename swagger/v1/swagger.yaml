---
openapi: 3.0.1
info:
  title: Sewer Line Repair API
  version: v1
  description: REST API for managing sewer line repairs
paths:
  "/api/v1/companies/search":
    get:
      summary: Search companies
      tags:
      - Companies
      parameters:
      - name: city
        in: query
        required: false
        description: City name (e.g., "Orlando")
        schema:
          type: string
      - name: state
        in: query
        required: false
        description: State code or name (e.g., "FL" or "Florida")
        schema:
          type: string
      - name: country
        in: query
        required: false
        description: 'Country code (default: "US")'
        schema:
          type: string
      - name: address
        in: query
        required: false
        description: Full address for proximity search
        schema:
          type: string
      - name: lat
        in: query
        required: false
        description: Latitude (use with lng)
        schema:
          type: number
      - name: lng
        in: query
        required: false
        description: Longitude (use with lat)
        schema:
          type: number
      - name: radius
        in: query
        required: false
        description: 'Search radius in miles (default: 25)'
        schema:
          type: integer
      - name: service_category
        in: query
        required: false
        description: Service type slug
        schema:
          type: string
      - name: verified_only
        in: query
        required: false
        description: Filter verified professionals only
        schema:
          type: boolean
      - name: min_rating
        in: query
        required: false
        description: Minimum rating (0-5)
        schema:
          type: number
      - name: sort
        in: query
        required: false
        description: 'Sort: "rating", "-rating", "distance", "name"'
        schema:
          type: string
      - name: page
        in: query
        required: false
        description: 'Page number (default: 1)'
        schema:
          type: integer
      - name: per_page
        in: query
        required: false
        description: 'Results per page (default: 20, max: 100)'
        schema:
          type: integer
      - name: include
        in: query
        required: false
        description: 'Include relationships: "city,reviews,service_categories,gallery_images"'
        schema:
          type: string
      responses:
        '200':
          description: companies found
          content:
            application/vnd.api+json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                        type:
                          type: string
                          example: company
                        attributes:
                          type: object
                          properties:
                            name:
                              type: string
                            slug:
                              type: string
                            phone:
                              type: string
                            email:
                              type: string
                            website:
                              type: string
                            street_address:
                              type: string
                            zip_code:
                              type: string
                            latitude:
                              type: string
                            longitude:
                              type: string
                            specialty:
                              type: string
                            service_level:
                              type: string
                            description:
                              type: string
                            average_rating:
                              type: string
                            total_reviews:
                              type: integer
                            verified_professional:
                              type: boolean
                            certified_partner:
                              type: boolean
                            licensed:
                              type: boolean
                            insured:
                              type: boolean
                            background_checked:
                              type: boolean
                            service_guarantee:
                              type: boolean
                            distance_miles:
                              type: number
                            distance_kilometers:
                              type: number
                            created_at:
                              type: string
                              format: date-time
                            updated_at:
                              type: string
                              format: date-time
                        relationships:
                          type: object
                          properties:
                            city:
                              type: object
                              properties:
                                data:
                                  type: object
                                  properties:
                                    id:
                                      type: string
                                    type:
                                      type: string
                                      example: city
                            service_categories:
                              type: object
                              properties:
                                data:
                                  type: array
                                  items:
                                    type: object
                                    properties:
                                      id:
                                        type: string
                                      type:
                                        type: string
                                        example: service_category
                        links:
                          type: object
                          properties:
                            self:
                              type: string
                  included:
                    type: array
                    items:
                      type: object
                  meta:
                    type: object
                    properties:
                      search_context:
                        type: object
                        properties:
                          query_type:
                            type: string
                          location:
                            type: string
                          coordinates:
                            type: object
                          radius_miles:
                            type: integer
                          filters_applied:
                            type: object
                      pagination:
                        type: object
                        properties:
                          current_page:
                            type: integer
                          per_page:
                            type: integer
                          total_pages:
                            type: integer
                          total_count:
                            type: integer
                          has_next:
                            type: boolean
                          has_prev:
                            type: boolean
                  links:
                    type: object
                    properties:
                      self:
                        type: string
                      first:
                        type: string
                      next:
                        type: string
                      last:
                        type: string
        '404':
          description: no results found
          content:
            application/vnd.api+json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      type: object
                      properties:
                        status:
                          type: string
                        code:
                          type: string
                        title:
                          type: string
                        detail:
                          type: string
                        meta:
                          type: object
                          properties:
                            suggestions:
                              type: array
                              items:
                                type: string
        '400':
          description: invalid parameters
          content:
            application/vnd.api+json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      type: object
                      properties:
                        status:
                          type: string
                        code:
                          type: string
                        title:
                          type: string
                        detail:
                          type: string
                        source:
                          type: object
                          properties:
                            parameter:
                              type: string
  "/api/v1/companies/{id}":
    parameters:
    - name: id
      in: path
      description: Company ID
      required: true
      schema:
        type: string
    - name: include
      in: query
      required: false
      description: 'Include relationships: "city,city.state,city.state.country,reviews,service_categories,gallery_images,certifications,service_areas"'
      schema:
        type: string
    get:
      summary: Retrieves a company
      tags:
      - Companies
      responses:
        '200':
          description: company found
          content:
            application/vnd.api+json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                      type:
                        type: string
                        example: company
                      attributes:
                        type: object
                        properties:
                          name:
                            type: string
                          slug:
                            type: string
                          phone:
                            type: string
                          email:
                            type: string
                          website:
                            type: string
                          street_address:
                            type: string
                          zip_code:
                            type: string
                          latitude:
                            type: string
                          longitude:
                            type: string
                          specialty:
                            type: string
                          service_level:
                            type: string
                          description:
                            type: string
                          average_rating:
                            type: string
                          total_reviews:
                            type: integer
                          verified_professional:
                            type: boolean
                          certified_partner:
                            type: boolean
                          licensed:
                            type: boolean
                          insured:
                            type: boolean
                          background_checked:
                            type: boolean
                          service_guarantee:
                            type: boolean
                          created_at:
                            type: string
                            format: date-time
                          updated_at:
                            type: string
                            format: date-time
                      relationships:
                        type: object
                      links:
                        type: object
                        properties:
                          self:
                            type: string
                  included:
                    type: array
                    items:
                      type: object
        '404':
          description: company not found
          content:
            application/vnd.api+json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      type: object
                      properties:
                        status:
                          type: string
                        code:
                          type: string
                        title:
                          type: string
                        detail:
                          type: string
  "/api/v1/locations/autocomplete":
    get:
      summary: Location autocomplete search
      tags:
      - Locations
      parameters:
      - name: q
        in: query
        required: true
        description: Search query (min 2 chars)
        schema:
          type: string
      - name: type
        in: query
        required: false
        description: 'Filter: "city", "state", "country"'
        schema:
          type: string
      - name: limit
        in: query
        required: false
        description: 'Max results (default: 10)'
        schema:
          type: integer
      responses:
        '200':
          description: locations found
          content:
            application/vnd.api+json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                        type:
                          type: string
                          example: city
                        attributes:
                          type: object
                          properties:
                            name:
                              type: string
                            slug:
                              type: string
                            latitude:
                              type: string
                            longitude:
                              type: string
                            companies_count:
                              type: integer
                        relationships:
                          type: object
                          properties:
                            state:
                              type: object
                              properties:
                                data:
                                  type: object
                                  properties:
                                    id:
                                      type: string
                                    type:
                                      type: string
                                      example: state
                        links:
                          type: object
                          properties:
                            self:
                              type: string
                        meta:
                          type: object
                          properties:
                            full_name:
                              type: string
                  included:
                    type: array
                    items:
                      type: object
                  meta:
                    type: object
                    properties:
                      query:
                        type: string
                      total_results:
                        type: integer
        '400':
          description: invalid query
          content:
            application/vnd.api+json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      type: object
                      properties:
                        status:
                          type: string
                        code:
                          type: string
                        title:
                          type: string
                        detail:
                          type: string
                        source:
                          type: object
                          properties:
                            parameter:
                              type: string
  "/api/v1/locations/geocode":
    post:
      summary: Geocode an address
      tags:
      - Locations
      parameters: []
      responses:
        '200':
          description: address geocoded
          content:
            application/vnd.api+json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                      type:
                        type: string
                        example: geocode_result
                      attributes:
                        type: object
                        properties:
                          formatted_address:
                            type: string
                          street_address:
                            type: string
                          zip_code:
                            type: string
                          latitude:
                            type: string
                          longitude:
                            type: string
                      relationships:
                        type: object
                        properties:
                          city:
                            type: object
                            properties:
                              data:
                                type: object
                                properties:
                                  id:
                                    type: string
                                  type:
                                    type: string
                                    example: city
                          state:
                            type: object
                            properties:
                              data:
                                type: object
                                properties:
                                  id:
                                    type: string
                                  type:
                                    type: string
                                    example: state
                          country:
                            type: object
                            properties:
                              data:
                                type: object
                                properties:
                                  id:
                                    type: string
                                  type:
                                    type: string
                                    example: country
                      meta:
                        type: object
                        properties:
                          nearby_companies_count:
                            type: integer
                  included:
                    type: array
                    items:
                      type: object
        '422':
          description: validation error - missing address
          content:
            application/vnd.api+json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      type: object
                      properties:
                        status:
                          type: string
                        code:
                          type: string
                        title:
                          type: string
                        detail:
                          type: string
                        source:
                          type: object
                          properties:
                            pointer:
                              type: string
                        meta:
                          type: object
                          properties:
                            suggestions:
                              type: array
                              items:
                                type: string
      requestBody:
        content:
          application/vnd.api+json:
            schema:
              type: object
              properties:
                data:
                  type: object
                  properties:
                    type:
                      type: string
                      example: geocode_request
                    attributes:
                      type: object
                      properties:
                        address:
                          type: string
                          example: 222 Orange Ave, Orlando, FL 32801
                      required:
                      - address
                  required:
                  - type
                  - attributes
              required:
              - data
  "/api/v1/companies/{company_id}/reviews":
    parameters:
    - name: company_id
      in: path
      description: Company ID
      required: true
      schema:
        type: string
    get:
      summary: List company reviews
      tags:
      - Reviews
      parameters:
      - name: verified_only
        in: query
        required: false
        description: Verified reviews only
        schema:
          type: boolean
      - name: min_rating
        in: query
        required: false
        description: Minimum rating (1-5)
        schema:
          type: integer
      - name: sort
        in: query
        required: false
        description: 'Sort: "review_date", "-review_date", "rating", "-rating"'
        schema:
          type: string
      - name: page
        in: query
        required: false
        description: 'Page number (default: 1)'
        schema:
          type: integer
      - name: per_page
        in: query
        required: false
        description: 'Results per page (default: 20, max: 100)'
        schema:
          type: integer
      responses:
        '200':
          description: filtered reviews
          content:
            application/vnd.api+json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                        type:
                          type: string
                          example: review
                        attributes:
                          type: object
                          properties:
                            reviewer_name:
                              type: string
                            review_date:
                              type: string
                              format: date
                            rating:
                              type: integer
                            review_text:
                              type: string
                            verified:
                              type: boolean
                            created_at:
                              type: string
                              format: date-time
                        relationships:
                          type: object
                          properties:
                            company:
                              type: object
                              properties:
                                data:
                                  type: object
                                  properties:
                                    id:
                                      type: string
                                    type:
                                      type: string
                                      example: company
                        links:
                          type: object
                          properties:
                            self:
                              type: string
                  meta:
                    type: object
                    properties:
                      pagination:
                        type: object
                        properties:
                          current_page:
                            type: integer
                          per_page:
                            type: integer
                          total_pages:
                            type: integer
                          total_count:
                            type: integer
                          has_next:
                            type: boolean
                          has_prev:
                            type: boolean
                      rating_distribution:
                        type: object
                        properties:
                          '1':
                            type: integer
                          '2':
                            type: integer
                          '3':
                            type: integer
                          '4':
                            type: integer
                          '5':
                            type: integer
                  links:
                    type: object
                    properties:
                      self:
                        type: string
                      first:
                        type: string
                      next:
                        type: string
                      last:
                        type: string
        '404':
          description: company not found
          content:
            application/vnd.api+json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      type: object
                      properties:
                        status:
                          type: string
                        code:
                          type: string
                        title:
                          type: string
                        detail:
                          type: string
  "/api/v1/states/{state_slug}/companies":
    parameters:
    - name: state_slug
      in: path
      description: State slug or code (e.g., "florida" or "FL")
      required: true
      schema:
        type: string
    get:
      summary: List companies in a state
      tags:
      - States
      parameters:
      - name: city
        in: query
        required: false
        description: Filter by city slug
        schema:
          type: string
      - name: service_category
        in: query
        required: false
        description: Service category slug
        schema:
          type: string
      - name: verified_only
        in: query
        required: false
        description: Verified professionals only
        schema:
          type: boolean
      - name: min_rating
        in: query
        required: false
        description: Minimum rating (0-5)
        schema:
          type: number
      - name: sort
        in: query
        required: false
        description: 'Sort: "rating", "-rating", "name", "-name"'
        schema:
          type: string
      - name: page
        in: query
        required: false
        description: 'Page number (default: 1)'
        schema:
          type: integer
      - name: per_page
        in: query
        required: false
        description: 'Results per page (default: 20, max: 100)'
        schema:
          type: integer
      - name: include
        in: query
        required: false
        description: 'Include relationships: "city,service_categories"'
        schema:
          type: string
      responses:
        '200':
          description: companies with filters
          content:
            application/vnd.api+json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                        type:
                          type: string
                          example: company
                        attributes:
                          type: object
                          properties:
                            name:
                              type: string
                            slug:
                              type: string
                            phone:
                              type: string
                            email:
                              type: string
                            website:
                              type: string
                            average_rating:
                              type: string
                            total_reviews:
                              type: integer
                            verified_professional:
                              type: boolean
                            certified_partner:
                              type: boolean
                            created_at:
                              type: string
                              format: date-time
                            updated_at:
                              type: string
                              format: date-time
                        relationships:
                          type: object
                          properties:
                            city:
                              type: object
                              properties:
                                data:
                                  type: object
                                  properties:
                                    id:
                                      type: string
                                    type:
                                      type: string
                                      example: city
                        links:
                          type: object
                          properties:
                            self:
                              type: string
                  included:
                    type: array
                    items:
                      type: object
                  meta:
                    type: object
                    properties:
                      state:
                        type: object
                        properties:
                          id:
                            type: string
                          name:
                            type: string
                          code:
                            type: string
                          slug:
                            type: string
                          total_companies:
                            type: integer
                          total_cities:
                            type: integer
                      pagination:
                        type: object
                        properties:
                          current_page:
                            type: integer
                          per_page:
                            type: integer
                          total_pages:
                            type: integer
                          total_count:
                            type: integer
                          has_next:
                            type: boolean
                          has_prev:
                            type: boolean
                  links:
                    type: object
                    properties:
                      self:
                        type: string
                      first:
                        type: string
                      next:
                        type: string
                      last:
                        type: string
        '404':
          description: state not found
          content:
            application/vnd.api+json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      type: object
                      properties:
                        status:
                          type: string
                        code:
                          type: string
                        title:
                          type: string
                        detail:
                          type: string
servers:
- url: http://localhost:3000
  description: Development server
- url: https://{defaultHost}
  variables:
    defaultHost:
      default: api.example.com
  description: Production server
components:
  schemas: {}
  securitySchemes: {}
